<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GitRepoCmdlet: GetRepoCmdlet/bin/Debug/GFSC.Services.EndOfTerm/GFSC.Services.EndOfTerm/Business/QuoteInformation.cs Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GitRepoCmdlet
   &#160;<span id="projectnumber">0.1b</span>
   </div>
   <div id="projectbrief">PS cmdlet to automate execution of git commands and launching specific VS</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_f13c24460aeb2c6c26eb67d391f6a849.html">GetRepoCmdlet</a></li><li class="navelem"><a class="el" href="dir_71fd00728bd3a84621d14f9d5675a273.html">bin</a></li><li class="navelem"><a class="el" href="dir_902219228f77b65622805b37de15d610.html">Debug</a></li><li class="navelem"><a class="el" href="dir_22171cc634133d5a9d44341840d956c5.html">GFSC.Services.EndOfTerm</a></li><li class="navelem"><a class="el" href="dir_94688af760162469fa359d75346ca4f0.html">GFSC.Services.EndOfTerm</a></li><li class="navelem"><a class="el" href="dir_30ab75c04e18fdfcdbac1bfa4d7d7e7d.html">Business</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">QuoteInformation.cs</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_business_2_quote_information_8cs.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Configuration;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">using</span> <a class="code" href="namespace_system.html">System</a>.Data;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_g_f_s_c.html">GFSC</a>.Services.EndOfTerm.Business</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;{</div><div class="line"><a name="l00007"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html">    7</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html">QuoteInformation</a></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;    {</div><div class="line"><a name="l00009"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a1ed86097ab0677ef0fbb381a444ee2d6">    9</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a1ed86097ab0677ef0fbb381a444ee2d6">CalculateAllQuotes</a>(<span class="keywordtype">string</span> QuotedBy, <span class="keywordtype">string</span> QuotedFor, <span class="keywordtype">string</span> DealerID, <span class="keywordtype">int</span> CustomerID, <span class="keywordtype">string</span> AssetIDList, <span class="keywordtype">string</span> IsPartialList, <span class="keywordtype">bool</span> IncludeFutures, <span class="keywordtype">bool</span> IsInternal, </div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;            <span class="keywordtype">bool</span> AllowUpgradeToKeep, <span class="keywordtype">bool</span> AllowUpgradeToReturn, <span class="keywordtype">bool</span> AllowBuyoutToKeepLessee, <span class="keywordtype">bool</span> AllowBuyoutToKeepVendor, <span class="keywordtype">bool</span> AllowBuyoutToReturn, <span class="keywordtype">string</span> Comments, <span class="keywordtype">string</span> Messages,</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;            <span class="keywordtype">bool</span> IncludeEstimatedPropertyTaxes)</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;        {</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;            CalculateUnpaidSalesTax(AssetIDList);</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;            <span class="keywordtype">int</span> QuoteID = 0;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;            <span class="keyword">using</span> (DataSet dsQuote = Data.QuoteInformation.CalculateAllQuotes(QuotedBy, QuotedFor, DealerID, CustomerID, AssetIDList, IsPartialList, IncludeFutures, IsInternal, AllowUpgradeToKeep,</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                AllowUpgradeToReturn, AllowBuyoutToKeepLessee, AllowBuyoutToKeepVendor, AllowBuyoutToReturn, Comments, Messages, IncludeEstimatedPropertyTaxes))</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;            {</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                <span class="keywordflow">if</span> (dsQuote.Tables[0].Rows.Count &gt; 0)</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;                {</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                    QuoteID = <span class="keywordtype">int</span>.Parse(dsQuote.Tables[0].Rows[0][0].ToString());</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                }</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;            }</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;            <span class="keywordflow">return</span> QuoteID;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        }</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a72d3ea2defba70b6b3b853ddbc988aea">   29</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> DataSet <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a72d3ea2defba70b6b3b853ddbc988aea">GetQuoteData</a>(<span class="keywordtype">int</span> QuoteHistoryID, <span class="keywordtype">string</span> QuoteType, <span class="keywordtype">bool</span> UsePlayground)</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        {</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.GetQuoteData(QuoteHistoryID, QuoteType, UsePlayground);</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        }</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a71befa60389b0814575b33e584bc358d">   34</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> DataSet <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a71befa60389b0814575b33e584bc358d">GetQuoteHistoryData</a>(<span class="keywordtype">int</span> QuoteHistoryID, <span class="keywordtype">bool</span> IsInternal, <span class="keywordtype">bool</span> UsePlayground)</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.GetQuoteHistoryData(QuoteHistoryID, IsInternal, UsePlayground);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        }</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#ab289a41ea16998c0a5ffa196b8eb9f64">   39</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> DataSet <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#ab289a41ea16998c0a5ffa196b8eb9f64">SearchQuoteHistory</a>(<span class="keywordtype">string</span> QuoteHistoryID, <span class="keywordtype">string</span> DealerName, <span class="keywordtype">string</span> ContractID, <span class="keywordtype">string</span> CustomerID, <span class="keywordtype">string</span> LesseeName, <span class="keywordtype">string</span> QuoteAmount, <span class="keywordtype">string</span> QuoteDate, <span class="keywordtype">bool</span> ShowAllQuotes)</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.SearchQuoteHistory(QuoteHistoryID, DealerName, ContractID, CustomerID, LesseeName, QuoteAmount, QuoteDate, ShowAllQuotes);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        }</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#ac658760f200d299fbe635e9833522c76">   44</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#ac658760f200d299fbe635e9833522c76">CopyDetailToPlayground</a>(<span class="keywordtype">int</span> QuoteHistoryID)</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        {</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.CopyDetailToPlayground(QuoteHistoryID);</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        }</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#ac87186a3ef46a918f343cc116669fd5a">   49</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> DataSet <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#ac87186a3ef46a918f343cc116669fd5a">GetBuyoutUpgradeQuoteMiscDataInfoZone</a>(<span class="keywordtype">string</span> QuoteHistoryID)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.GetBuyoutUpgradeQuoteMiscDataInfoZone(QuoteHistoryID, <span class="stringliteral">&quot;Dealer&quot;</span>);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        }</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a471a2eefa31b402a2c8d96878f3735b9">   54</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> DataSet <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a471a2eefa31b402a2c8d96878f3735b9">GetBuyoutUpgradeQuoteMiscDataInfoZoneV2</a>(<span class="keywordtype">string</span> QuoteHistoryID)</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        {</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.GetBuyoutUpgradeQuoteMiscDataInfoZoneV2(QuoteHistoryID, <span class="stringliteral">&quot;Dealer&quot;</span>);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#ac37cc38cb0a087172577503a1b8dbe11">   59</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> DataSet <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#ac37cc38cb0a087172577503a1b8dbe11">GetFutureMisc</a>(<span class="keywordtype">int</span> QuoteHistoryID, <span class="keywordtype">string</span> QuoteType, <span class="keywordtype">string</span> ContractID, <span class="keywordtype">bool</span> UsePlayground)</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.GetFutureMisc(QuoteHistoryID, QuoteType, ContractID, UsePlayground);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#aefb3431470834760912e5f695ac8a704">   64</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> DataSet <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#aefb3431470834760912e5f695ac8a704">GetMiscDetails</a>(<span class="keywordtype">int</span> QuoteHistoryID, <span class="keywordtype">string</span> QuoteType, <span class="keywordtype">string</span> ContractID, <span class="keywordtype">bool</span> UsePlayground)</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.GetMiscDetails(QuoteHistoryID, QuoteType, ContractID, UsePlayground);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        }</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a6626649b8bb5656489ee90f1704e312a">   69</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a6626649b8bb5656489ee90f1704e312a">AddInvoicedCharge</a>(<span class="keywordtype">int</span> QuoteHistoryID, <span class="keywordtype">string</span> QuoteType, <span class="keywordtype">string</span> ContractID, <span class="keywordtype">string</span> GLCode, <span class="keywordtype">bool</span> PayableToDealer, <span class="keywordtype">string</span> PayableToDealerID, <span class="keywordtype">string</span> Description, <span class="keywordtype">string</span> DueDate, decimal Amount, <span class="keywordtype">bool</span> ChargeTax)</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        {</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.AddInvoicedCharge(QuoteHistoryID, QuoteType, ContractID, GLCode, PayableToDealer, PayableToDealerID, Description, DueDate, Amount, ChargeTax);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="comment">//bool Success = true;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="comment">//bool UsePropertyTax = false;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <span class="comment">//bool ShouldBeTaxed = true;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <span class="comment">//using (DataSet dsPropertyTaxGLCodes = Data.QuoteInformation.GetPropertyTaxGLCodes())</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="comment">//{</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="comment">//    UsePropertyTax = dsPropertyTaxGLCodes != null &amp;&amp; dsPropertyTaxGLCodes.Tables[0].Rows.Count &gt; 0 &amp;&amp; dsPropertyTaxGLCodes.Tables[0].Select(&quot;GLCode=&#39;&quot; + GLCode + &quot;&#39;&quot;).Length &gt; 0;</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="comment">//}</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="comment">//using (DataSet dsGLCodes = Data.MiscInformation.GetGLCodesTaxableByDefault())</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <span class="comment">//{</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="comment">//    if (dsGLCodes != null &amp;&amp; dsGLCodes.Tables[0].Rows.Count &gt; 0)</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="comment">//    {</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="comment">//        DataRow[] drMatching = dsGLCodes.Tables[0].Select(&quot;GLCode=&#39;&quot; + GLCode + &quot;&#39;&quot;);</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="comment">//        if(drMatching.Length &gt; 0)</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <span class="comment">//            ShouldBeTaxed = Convert.ToBoolean(drMatching[0][&quot;AddTaxByDefault&quot;].ToString());</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="comment">//    }</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <span class="comment">//}</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <span class="comment">//using (DataSet ds = Data.QuoteInformation.GetQuoteHistoryDetail(QuoteHistoryID, QuoteType, ContractID, UsePlayground))</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="comment">//{</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="comment">//    if (ds != null)</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <span class="comment">//    {</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            <span class="comment">//        foreach (DataRow dr in ds.Tables[0].Rows)</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="comment">//        {</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            <span class="comment">//            StringBuilder sb = new StringBuilder();</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="comment">//            int MiscID = GetNextMiscID(dr[&quot;MiscInvoiceDetails&quot;]);</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <span class="comment">//            int AssetID = Convert.ToInt32(dr[&quot;AssetID&quot;].ToString());</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;            <span class="comment">//            decimal QuoteCostPct = Convert.ToDecimal(dr[&quot;QuoteCostPct&quot;].ToString());</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="comment">//            decimal TaxRate = Convert.ToDecimal(dr[UsePropertyTax ? &quot;PropertyTaxSalesTaxRate&quot; : &quot;MiscSalesTaxRate&quot;].ToString()) / 100.0M;</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="comment">//            decimal AssetMiscAmount = Amount * (QuoteCostPct / 100.0M);</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <span class="comment">//            decimal AssetMiscTaxAmount = (ChargeTax &amp;&amp; ShouldBeTaxed) ? (AssetMiscAmount * TaxRate) : 0.0M;</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="comment">//            sb.Append(&quot;&lt;InvoiceCharge&gt;&quot;);</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="comment">//            sb.Append(&quot;&lt;MiscID&gt;&quot; + MiscID.ToString() + &quot;&lt;/MiscID&gt;&quot;);</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="comment">//            sb.Append(&quot;&lt;GLCode&gt;&quot; + GLCode + &quot;&lt;/GLCode&gt;&quot;);</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="comment">//            sb.Append(&quot;&lt;ContractID&gt;&quot; + ContractID + &quot;&lt;/ContractID&gt;&quot;);</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="comment">//            sb.Append(&quot;&lt;MiscDesc&gt;&quot; + Description + &quot;&lt;/MiscDesc&gt;&quot;);</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="comment">//            sb.Append(&quot;&lt;PayDealer&gt;&quot; + (PayableToDealer ? &quot;1&quot; : &quot;0&quot;) + &quot;&lt;/PayDealer&gt;&quot;);</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="comment">//            sb.Append(&quot;&lt;DealerID&gt;&quot; + PayableToDealerID + &quot;&lt;/DealerID&gt;&quot;);</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="comment">//            sb.Append(&quot;&lt;DueDate&gt;&quot; + DueDate + &quot;&lt;/DueDate&gt;&quot;);</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="comment">//            sb.Append(&quot;&lt;MiscAmount&gt;&quot; + String.Format(&quot;{0:0.0000}&quot;, AssetMiscAmount) + &quot;&lt;/MiscAmount&gt;&quot;);</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="comment">//            sb.Append(&quot;&lt;TaxAmount&gt;&quot; + String.Format(&quot;{0:0.0000}&quot;, AssetMiscTaxAmount) + &quot;&lt;/TaxAmount&gt;&quot;);</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="comment">//            sb.Append(&quot;&lt;InInfolease&gt;0&lt;/InInfolease&gt;&quot;);</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="comment">//            sb.Append(&quot;&lt;/InvoiceCharge&gt;&quot;);</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="comment">//            string MiscInvoiceDetails = &quot;&quot;;</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="comment">//            //If misc items already exist, make it the last node in the list</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="comment">//            if (dr[&quot;MiscInvoiceDetails&quot;] != DBNull.Value &amp;&amp; dr[&quot;MiscInvoiceDetails&quot;].ToString().Trim() != &quot;&quot;)</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="comment">//                MiscInvoiceDetails = dr[&quot;MiscInvoiceDetails&quot;].ToString().Replace(&quot;&lt;/MiscInvoicedDetails&gt;&quot;, sb.ToString() + &quot;&lt;/MiscInvoicedDetails&gt;&quot;);</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <span class="comment">//            else</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="comment">//                MiscInvoiceDetails = &quot;&lt;MiscInvoicedDetails&gt;&quot; + sb.ToString() + &quot;&lt;/MiscInvoicedDetails&gt;&quot;;</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="comment">//            if (!Data.QuoteInformation.UpdateMiscInvoiceDetails(QuoteHistoryID, QuoteType, ContractID, AssetID, MiscInvoiceDetails))</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="comment">//                Success = false;</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="comment">//        }</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="comment">//    }</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="comment">//}</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="comment">//return Success;</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a5f2044beac69eccd10a772590f5d72ea">  138</a></span>&#160;        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a5f2044beac69eccd10a772590f5d72ea">GetNextMiscID</a>(<span class="keywordtype">object</span> xmlData)</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keywordtype">int</span> i = 1;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keywordflow">if</span> (xmlData != DBNull.Value)</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                <span class="keywordflow">while</span> (xmlData.ToString().Contains(<span class="stringliteral">&quot;&lt;MiscID&gt;&quot;</span> + i.ToString() + <span class="stringliteral">&quot;&lt;/MiscID&gt;&quot;</span>))</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    i++;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="keywordflow">return</span> i;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a7e53d4f942fa7324f031d75169dba969">  153</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a7e53d4f942fa7324f031d75169dba969">UpdateQuoteData</a>(<span class="keywordtype">int</span> QuoteHistoryID, <span class="keywordtype">string</span> QuoteType, <span class="keywordtype">string</span> ContractID, <span class="keywordtype">string</span> FieldName, <span class="keywordtype">string</span> NewAmount, <span class="keywordtype">bool</span> ReCalcTax)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.UpdateQuoteData(QuoteHistoryID, QuoteType, ContractID, FieldName, NewAmount, ReCalcTax);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#acbd750495a03f04ea5010ea3de3cf470">  158</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#acbd750495a03f04ea5010ea3de3cf470">UpdateFutureCharge</a>(<span class="keywordtype">int</span> QuoteHistoryID, <span class="keywordtype">string</span> QuoteType, <span class="keywordtype">string</span> ContractID, <span class="keywordtype">string</span> MiscID, <span class="keywordtype">string</span> MiscFirstPymtDate, <span class="keywordtype">string</span> FieldName, <span class="keywordtype">string</span> NewAmount, <span class="keywordtype">int</span>? AssetID, <span class="keywordtype">bool</span> ReCalcTax)</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.UpdateFutureCharge(QuoteHistoryID, QuoteType, ContractID, MiscID, MiscFirstPymtDate, FieldName, NewAmount, AssetID, ReCalcTax);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="comment">//bool Success = true;</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            </div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="comment">//using (DataSet dsPropertyTaxGLCodes = Data.QuoteInformation.GetPropertyTaxGLCodes())</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <span class="comment">//{</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="comment">//    using (DataSet ds = Data.QuoteInformation.GetQuoteHistoryDetail(QuoteHistoryID, QuoteType, ContractID, UsePlayground))</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="comment">//    {</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="comment">//        if (ds != null)</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="comment">//        {</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="comment">//            foreach (DataRow dr in ds.Tables[0].Rows)</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="comment">//            {</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="comment">//                StringBuilder sb = new StringBuilder();</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="comment">//                int AssetID = Convert.ToInt32(dr[&quot;AssetID&quot;].ToString());</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="comment">//                decimal QuoteCostPct = Convert.ToDecimal(dr[&quot;QuoteCostPct&quot;].ToString()) / 100.0M;</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="comment">//                using (DataSet dsMisc = Data.QuoteInformation.GetFutureMisc(QuoteHistoryID, QuoteType, ContractID, UsePlayground))</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="comment">//                {</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="comment">//                    if (dsMisc != null)</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="comment">//                    {</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="comment">//                        foreach (DataRow drMisc in dsMisc.Tables[0].Rows)</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="comment">//                        {</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="comment">//                            string GLCode = drMisc[&quot;MiscGLCode&quot;].ToString();</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;FutureCharge&gt;&quot;);</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;MiscKey&gt;&quot; + drMisc[&quot;MiscKey&quot;].ToString() + &quot;&lt;/MiscKey&gt;&quot;);</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;ContractID&gt;&quot; + drMisc[&quot;ContractID&quot;].ToString() + &quot;&lt;/ContractID&gt;&quot;);</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;MiscDesc&gt;&quot; + drMisc[&quot;MiscDesc&quot;].ToString() + &quot;&lt;/MiscDesc&gt;&quot;);</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;MiscGLCode&gt;&quot; + GLCode + &quot;&lt;/MiscGLCode&gt;&quot;);</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;MiscBillingCycle&gt;&quot; + drMisc[&quot;MiscBillingCycle&quot;].ToString()  + &quot;&lt;/MiscBillingCycle&gt;&quot;);</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;MiscFirstPymtDate&gt;&quot; + drMisc[&quot;MiscFirstPymtDate&quot;].ToString() + &quot;&lt;/MiscFirstPymtDate&gt;&quot;);</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;MiscFinalPymtDate&gt;&quot; + drMisc[&quot;MiscFinalPymtDate&quot;].ToString() + &quot;&lt;/MiscFinalPymtDate&gt;&quot;);</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;MiscNextPymtDate&gt;&quot; + drMisc[&quot;MiscNextPymtDate&quot;].ToString() + &quot;&lt;/MiscNextPymtDate&gt;&quot;);</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="comment">//                            decimal MiscAmount = 0.0M;</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="comment">//                            decimal MiscTaxAmount = 0.0M;</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="comment">//                            string MiscRemainingPymts = &quot;&quot;;</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="comment">//                            if (MiscID == drMisc[&quot;MiscKey&quot;].ToString() &amp;&amp; Convert.ToDateTime(MiscFirstPymtDate) == Convert.ToDateTime(drMisc[&quot;MiscFirstPymtDate&quot;].ToString()))</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="comment">//                            {</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="comment">//                                MiscAmount = FieldName == &quot;MiscAmount&quot; ? Convert.ToDecimal(NewAmount) : Convert.ToDecimal(drMisc[&quot;MiscAmount&quot;].ToString());</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="comment">//                                MiscTaxAmount = FieldName == &quot;TaxAmount&quot; ? Convert.ToDecimal(NewAmount) : Convert.ToDecimal(drMisc[&quot;TaxAmount&quot;].ToString());</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="comment">//                                MiscRemainingPymts = FieldName == &quot;MiscRemainingPymts&quot; ? NewAmount : drMisc[&quot;MiscRemainingPymts&quot;].ToString();</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="comment">//                                if (ReCalcTax &amp;&amp; FieldName == &quot;MiscAmount&quot;)</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <span class="comment">//                                {</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="comment">//                                    decimal OriginalMiscAmount = Convert.ToDecimal(drMisc[&quot;MiscAmount&quot;].ToString());</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="comment">//                                    decimal OriginalTaxAmount = Convert.ToDecimal(drMisc[&quot;TaxAmount&quot;].ToString());</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="comment">//                                    bool UsePropertyTax = dsPropertyTaxGLCodes != null &amp;&amp; dsPropertyTaxGLCodes.Tables[0].Select(&quot;GLCode=&#39;&quot; + GLCode + &quot;&#39;&quot;).Length &gt; 0;</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <span class="comment">//                                    decimal TaxRate = Convert.ToDecimal(drMisc[UsePropertyTax ? &quot;PropertyTaxSalesTaxRate&quot; : &quot;MiscSalesTaxRate&quot;].ToString()) / 100.0M;</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="comment">//                                    MiscTaxAmount = (OriginalMiscAmount &gt; 0 &amp;&amp; OriginalTaxAmount == 0) ? 0.0M : MiscAmount * TaxRate;</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="comment">//                                }</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="comment">//                            }</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="comment">//                            else</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="comment">//                            {</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="comment">//                                MiscAmount = Convert.ToDecimal(drMisc[&quot;MiscAmount&quot;].ToString());</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="comment">//                                MiscTaxAmount = Convert.ToDecimal(drMisc[&quot;TaxAmount&quot;].ToString());</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="comment">//                                MiscRemainingPymts = drMisc[&quot;MiscRemainingPymts&quot;].ToString();</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="comment">//                            }</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;MiscAmount&gt;&quot; + String.Format(&quot;{0:0.0000}&quot;, MiscAmount * QuoteCostPct) + &quot;&lt;/MiscAmount&gt;&quot;);</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;TaxAmount&gt;&quot; + String.Format(&quot;{0:0.0000}&quot;, MiscTaxAmount * QuoteCostPct) + &quot;&lt;/TaxAmount&gt;&quot;);</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;MiscRemainingPymts&gt;&quot; + MiscRemainingPymts + &quot;&lt;/MiscRemainingPymts&gt;&quot;);</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;/FutureCharge&gt;&quot;);</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="comment">//                        }</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="comment">//                    }</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="comment">//                }</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <span class="comment">//                if (!Data.QuoteInformation.UpdateFutureMisc(QuoteHistoryID, QuoteType, ContractID, AssetID, &quot;&lt;FutureMiscDetails&gt;&quot; + sb.ToString() + &quot;&lt;/FutureMiscDetails&gt;&quot;))</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="comment">//                    Success = false;</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="comment">//            }</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="comment">//        }</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="comment">//    }</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="comment">//}</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="comment">//return Success;</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a84306997ff08f23dbeb1404360d922a2">  240</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a84306997ff08f23dbeb1404360d922a2">UpdateInvoicedCharge</a>(<span class="keywordtype">int</span> QuoteHistoryID, <span class="keywordtype">string</span> QuoteType, <span class="keywordtype">string</span> ContractID, <span class="keywordtype">string</span> MiscID, <span class="keywordtype">string</span> FieldName, <span class="keywordtype">string</span> NewAmount, <span class="keywordtype">int</span>? AssetID, <span class="keywordtype">bool</span> ReCalcTax)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.UpdateInvoicedCharge(QuoteHistoryID, QuoteType, ContractID, MiscID, FieldName, NewAmount, AssetID, ReCalcTax);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="comment">//bool Success = true;</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="comment">//using (DataSet dsPropertyTaxGLCodes = Data.QuoteInformation.GetPropertyTaxGLCodes())</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="comment">//{</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="comment">//    using (DataSet ds = Data.QuoteInformation.GetQuoteHistoryDetail(QuoteHistoryID, QuoteType, ContractID, UsePlayground))</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="comment">//    {</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="comment">//        if (ds != null)</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="comment">//        {</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="comment">//            foreach (DataRow dr in ds.Tables[0].Rows)</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="comment">//            {</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="comment">//                StringBuilder sb = new StringBuilder();</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="comment">//                int AssetID = Convert.ToInt32(dr[&quot;AssetID&quot;].ToString());</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="comment">//                decimal QuoteCostPct = Convert.ToDecimal(dr[&quot;QuoteCostPct&quot;].ToString()) / 100.0M;</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="comment">//                using(DataSet dsMisc = Data.QuoteInformation.GetMiscDetails(QuoteHistoryID, QuoteType, ContractID, UsePlayground))</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="comment">//                {</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="comment">//                    if (dsMisc != null)</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            <span class="comment">//                    {</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="comment">//                        foreach (DataRow drMisc in dsMisc.Tables[0].Rows)</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="comment">//                        {</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="comment">//                            string GLCode = drMisc[&quot;GLCode&quot;].ToString();</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;InvoiceCharge&gt;&quot;);</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;MiscID&gt;&quot; + drMisc[&quot;MiscID&quot;].ToString() + &quot;&lt;/MiscID&gt;&quot;);</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;GLCode&gt;&quot; + GLCode + &quot;&lt;/GLCode&gt;&quot;);</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;ContractID&gt;&quot; + drMisc[&quot;ContractID&quot;].ToString() + &quot;&lt;/ContractID&gt;&quot;);</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;MiscDesc&gt;&quot; + drMisc[&quot;MiscDesc&quot;].ToString() + &quot;&lt;/MiscDesc&gt;&quot;);</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;PayDealer&gt;&quot; + (Convert.ToBoolean(drMisc[&quot;PayDealer&quot;].ToString()) ? &quot;1&quot; : &quot;0&quot;) + &quot;&lt;/PayDealer&gt;&quot;);</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;DealerID&gt;&quot; + drMisc[&quot;DealerID&quot;].ToString() + &quot;&lt;/DealerID&gt;&quot;);</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;DueDate&gt;&quot; + drMisc[&quot;DueDate&quot;].ToString() + &quot;&lt;/DueDate&gt;&quot;);</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="comment">//                            decimal MiscAmount = 0.0M;</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="comment">//                            decimal MiscTaxAmount = 0.0M;</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="comment">//                            if (MiscID == drMisc[&quot;MiscID&quot;].ToString())</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="comment">//                            {</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <span class="comment">//                                MiscAmount = FieldName == &quot;MiscAmount&quot; ? Convert.ToDecimal(NewAmount) : Convert.ToDecimal(drMisc[&quot;MiscAmount&quot;].ToString());</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="comment">//                                MiscTaxAmount = FieldName == &quot;TaxAmount&quot; ? Convert.ToDecimal(NewAmount) : Convert.ToDecimal(drMisc[&quot;TaxAmount&quot;].ToString());</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="comment">//                                if (ReCalcTax &amp;&amp; FieldName == &quot;MiscAmount&quot;)</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="comment">//                                {</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="comment">//                                    decimal OriginalMiscAmount = Convert.ToDecimal(drMisc[&quot;MiscAmount&quot;].ToString());</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="comment">//                                    decimal OriginalTaxAmount = Convert.ToDecimal(drMisc[&quot;TaxAmount&quot;].ToString());</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="comment">//                                    bool UsePropertyTax = dsPropertyTaxGLCodes != null &amp;&amp; dsPropertyTaxGLCodes.Tables[0].Select(&quot;GLCode=&#39;&quot; + GLCode + &quot;&#39;&quot;).Length &gt; 0;</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="comment">//                                    decimal TaxRate = Convert.ToDecimal(drMisc[UsePropertyTax ? &quot;PropertyTaxSalesTaxRate&quot; : &quot;MiscSalesTaxRate&quot;].ToString()) / 100.0M;</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="comment">//                                    MiscTaxAmount = (OriginalMiscAmount &gt; 0 &amp;&amp; OriginalTaxAmount == 0) ? 0.0M : MiscAmount * TaxRate;</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <span class="comment">//                                }</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="comment">//                            }</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="comment">//                            else</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="comment">//                            {</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="comment">//                                MiscAmount = Convert.ToDecimal(drMisc[&quot;MiscAmount&quot;].ToString());</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <span class="comment">//                                MiscTaxAmount = Convert.ToDecimal(drMisc[&quot;TaxAmount&quot;].ToString());</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="comment">//                            }</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;MiscAmount&gt;&quot; + String.Format(&quot;{0:0.0000}&quot;, MiscAmount * QuoteCostPct) + &quot;&lt;/MiscAmount&gt;&quot;);</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;TaxAmount&gt;&quot; + String.Format(&quot;{0:0.0000}&quot;, MiscTaxAmount * QuoteCostPct) + &quot;&lt;/TaxAmount&gt;&quot;);</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;InInfolease&gt;&quot; + (Convert.ToBoolean(drMisc[&quot;InInfolease&quot;].ToString()) ? &quot;1&quot; : &quot;0&quot;) + &quot;&lt;/InInfolease&gt;&quot;);</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="comment">//                            sb.Append(&quot;&lt;/InvoiceCharge&gt;&quot;);</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="comment">//                        }</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            <span class="comment">//                    }</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="comment">//                }</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <span class="comment">//                if (!Data.QuoteInformation.UpdateMiscInvoiceDetails(QuoteHistoryID, QuoteType, ContractID, AssetID, &quot;&lt;MiscInvoicedDetails&gt;&quot; + sb.ToString() + &quot;&lt;/MiscInvoicedDetails&gt;&quot;))</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="comment">//                    Success = false;</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="comment">//            }</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <span class="comment">//        }</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="comment">//    }</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="comment">//}</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="comment">//return Success;</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#addf81d446292ceb91b9d98db9cf07191">  318</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#addf81d446292ceb91b9d98db9cf07191">SaveUpdatedQuoteData</a>(<span class="keywordtype">int</span> QuoteHistoryID, <span class="keywordtype">string</span> NewQuotedBy, <span class="keywordtype">string</span> NewQuotedFor, DateTime NewExpirationDate, <span class="keywordtype">string</span> NewComment)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.SaveUpdatedQuoteData(QuoteHistoryID, NewQuotedBy, NewQuotedFor, NewExpirationDate, NewComment);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a2d65a66bd7a0a47c3ff3386cca19da22">  323</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a2d65a66bd7a0a47c3ff3386cca19da22">ChangeIncludeQuote</a>(<span class="keywordtype">int</span> QuoteHistoryID, <span class="keywordtype">string</span> QuoteType)</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.ChangeIncludeQuote(QuoteHistoryID, QuoteType);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a54426a5a7c6347e1cf8010437e6913f5">  328</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> DataSet <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a54426a5a7c6347e1cf8010437e6913f5">CommitQuote</a>(<span class="keywordtype">int</span> QuoteHistoryID, <span class="keywordtype">string</span> QuoteType)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        {</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.CommitQuote(QuoteHistoryID, QuoteType);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        }</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a72c63c3508511b362a073bbefb001992">  333</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a72c63c3508511b362a073bbefb001992">UnCommitQuote</a>(<span class="keywordtype">int</span> QuoteHistoryID)</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        {</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.UnCommitQuote(QuoteHistoryID);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        }</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a3dd309d2f414a21754fe4873ec8657c5">  338</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> DataSet <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a3dd309d2f414a21754fe4873ec8657c5">GetQuoteMessages</a>(<span class="keywordtype">int</span> QuoteHistoryID)</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="keywordflow">return</span> Data.QuoteInformation.GetQuoteMessages(QuoteHistoryID);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#ac9c7044adf8240f88acd089eef7257f6">  343</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#ac9c7044adf8240f88acd089eef7257f6">AddInvoicedChargeInfoZone</a>(<span class="keywordtype">int</span> QuoteHistoryID, <span class="keywordtype">string</span> ContractID, <span class="keywordtype">string</span> GLCode, <span class="keywordtype">string</span> DealerID, <span class="keywordtype">string</span> Description, <span class="keywordtype">string</span> DueDate, decimal Amount)</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            <span class="keywordflow">if</span> (CopyDetailToPlayground(QuoteHistoryID))</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <span class="keywordtype">bool</span> UTK = AddInvoicedCharge(QuoteHistoryID, <span class="stringliteral">&quot;Upgrade to Keep&quot;</span>, ContractID, GLCode, <span class="keyword">true</span>, DealerID, Description, DueDate, Amount, <span class="keyword">true</span>);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                <span class="keywordtype">bool</span> UTR = AddInvoicedCharge(QuoteHistoryID, <span class="stringliteral">&quot;Upgrade to Return&quot;</span>, ContractID, GLCode, <span class="keyword">true</span>, DealerID, Description, DueDate, Amount, <span class="keyword">true</span>);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                <span class="keywordtype">bool</span> BTKL = AddInvoicedCharge(QuoteHistoryID, <span class="stringliteral">&quot;Buyout to Keep - Lessee&quot;</span>, ContractID, GLCode, <span class="keyword">true</span>, DealerID, Description, DueDate, Amount, <span class="keyword">true</span>);</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                <span class="keywordtype">bool</span> BTKV = AddInvoicedCharge(QuoteHistoryID, <span class="stringliteral">&quot;Buyout to Keep - Vendor&quot;</span>, ContractID, GLCode, <span class="keyword">true</span>, DealerID, Description, DueDate, Amount, <span class="keyword">true</span>);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                <span class="keywordtype">bool</span> BTR = AddInvoicedCharge(QuoteHistoryID, <span class="stringliteral">&quot;Buyout to Return&quot;</span>, ContractID, GLCode, <span class="keyword">true</span>, DealerID, Description, DueDate, Amount, <span class="keyword">true</span>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <span class="keywordflow">return</span> UTK &amp;&amp; UTR &amp;&amp; BTKL &amp;&amp; BTKV &amp;&amp; BTR;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno"><a class="line" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a7dd78540ce884730d4d6f8e9d3b3e6a1">  359</a></span>&#160;        <span class="keyword">internal</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a7dd78540ce884730d4d6f8e9d3b3e6a1">CalculateUnpaidSalesTax</a>(<span class="keywordtype">string</span> AssetIDList)</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        {</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="keywordtype">string</span> ContractIDList = Data.UnpaidOpenItemInformation.GetContractsFromAssets(AssetIDList);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keywordflow">foreach</span>(<span class="keywordtype">string</span> ContractID <span class="keywordflow">in</span> ContractIDList.Split(<span class="charliteral">&#39;,&#39;</span>))</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                <span class="keywordtype">string</span> UnpaidOpenItemXML = Data.UnpaidOpenItemInformation.GetOpenItemXML(ContractID);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                <span class="keywordtype">string</span> ReturnXML = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="keywordflow">try</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                    <span class="keyword">using</span> (IMService.IMService ims = <span class="keyword">new</span> IMService.IMService())</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                    {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                        ReturnXML = ims.ExecuteIntegrationManagerCall(ConfigurationManager.AppSettings[<span class="stringliteral">&quot;IntegrationManagerDB&quot;</span>].ToString(), UnpaidOpenItemXML);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                    }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                <span class="keywordflow">catch</span>(Exception ex)</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                {</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                    <span class="keywordtype">string</span> x = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                <span class="keywordtype">double</span> UnpaidSalesTax = Data.UnpaidOpenItemInformation.CalculateUnpaidSalesTax(ReturnXML);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                Data.UnpaidOpenItemInformation.InsertUnpaidSalesTax(ContractID, UnpaidSalesTax);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div><div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_a71befa60389b0814575b33e584bc358d"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a71befa60389b0814575b33e584bc358d">GFSC.Services.EndOfTerm.Business.QuoteInformation.GetQuoteHistoryData</a></div><div class="ttdeci">static DataSet GetQuoteHistoryData(int QuoteHistoryID, bool IsInternal, bool UsePlayground)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00034">QuoteInformation.cs:34</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_a72c63c3508511b362a073bbefb001992"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a72c63c3508511b362a073bbefb001992">GFSC.Services.EndOfTerm.Business.QuoteInformation.UnCommitQuote</a></div><div class="ttdeci">static bool UnCommitQuote(int QuoteHistoryID)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00333">QuoteInformation.cs:333</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_acbd750495a03f04ea5010ea3de3cf470"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#acbd750495a03f04ea5010ea3de3cf470">GFSC.Services.EndOfTerm.Business.QuoteInformation.UpdateFutureCharge</a></div><div class="ttdeci">static bool UpdateFutureCharge(int QuoteHistoryID, string QuoteType, string ContractID, string MiscID, string MiscFirstPymtDate, string FieldName, string NewAmount, int? AssetID, bool ReCalcTax)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00158">QuoteInformation.cs:158</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_a471a2eefa31b402a2c8d96878f3735b9"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a471a2eefa31b402a2c8d96878f3735b9">GFSC.Services.EndOfTerm.Business.QuoteInformation.GetBuyoutUpgradeQuoteMiscDataInfoZoneV2</a></div><div class="ttdeci">static DataSet GetBuyoutUpgradeQuoteMiscDataInfoZoneV2(string QuoteHistoryID)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00054">QuoteInformation.cs:54</a></div></div>
<div class="ttc" id="namespace_system_html"><div class="ttname"><a href="namespace_system.html">System</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_ac37cc38cb0a087172577503a1b8dbe11"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#ac37cc38cb0a087172577503a1b8dbe11">GFSC.Services.EndOfTerm.Business.QuoteInformation.GetFutureMisc</a></div><div class="ttdeci">static DataSet GetFutureMisc(int QuoteHistoryID, string QuoteType, string ContractID, bool UsePlayground)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00059">QuoteInformation.cs:59</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_a2d65a66bd7a0a47c3ff3386cca19da22"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a2d65a66bd7a0a47c3ff3386cca19da22">GFSC.Services.EndOfTerm.Business.QuoteInformation.ChangeIncludeQuote</a></div><div class="ttdeci">static bool ChangeIncludeQuote(int QuoteHistoryID, string QuoteType)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00323">QuoteInformation.cs:323</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_a5f2044beac69eccd10a772590f5d72ea"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a5f2044beac69eccd10a772590f5d72ea">GFSC.Services.EndOfTerm.Business.QuoteInformation.GetNextMiscID</a></div><div class="ttdeci">static int GetNextMiscID(object xmlData)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00138">QuoteInformation.cs:138</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_ac658760f200d299fbe635e9833522c76"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#ac658760f200d299fbe635e9833522c76">GFSC.Services.EndOfTerm.Business.QuoteInformation.CopyDetailToPlayground</a></div><div class="ttdeci">static bool CopyDetailToPlayground(int QuoteHistoryID)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00044">QuoteInformation.cs:44</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_a54426a5a7c6347e1cf8010437e6913f5"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a54426a5a7c6347e1cf8010437e6913f5">GFSC.Services.EndOfTerm.Business.QuoteInformation.CommitQuote</a></div><div class="ttdeci">static DataSet CommitQuote(int QuoteHistoryID, string QuoteType)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00328">QuoteInformation.cs:328</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_a6626649b8bb5656489ee90f1704e312a"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a6626649b8bb5656489ee90f1704e312a">GFSC.Services.EndOfTerm.Business.QuoteInformation.AddInvoicedCharge</a></div><div class="ttdeci">static bool AddInvoicedCharge(int QuoteHistoryID, string QuoteType, string ContractID, string GLCode, bool PayableToDealer, string PayableToDealerID, string Description, string DueDate, decimal Amount, bool ChargeTax)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00069">QuoteInformation.cs:69</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_a7e53d4f942fa7324f031d75169dba969"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a7e53d4f942fa7324f031d75169dba969">GFSC.Services.EndOfTerm.Business.QuoteInformation.UpdateQuoteData</a></div><div class="ttdeci">static bool UpdateQuoteData(int QuoteHistoryID, string QuoteType, string ContractID, string FieldName, string NewAmount, bool ReCalcTax)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00153">QuoteInformation.cs:153</a></div></div>
<div class="ttc" id="namespace_g_f_s_c_html"><div class="ttname"><a href="namespace_g_f_s_c.html">GFSC</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_a84306997ff08f23dbeb1404360d922a2"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a84306997ff08f23dbeb1404360d922a2">GFSC.Services.EndOfTerm.Business.QuoteInformation.UpdateInvoicedCharge</a></div><div class="ttdeci">static bool UpdateInvoicedCharge(int QuoteHistoryID, string QuoteType, string ContractID, string MiscID, string FieldName, string NewAmount, int? AssetID, bool ReCalcTax)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00240">QuoteInformation.cs:240</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_a72d3ea2defba70b6b3b853ddbc988aea"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a72d3ea2defba70b6b3b853ddbc988aea">GFSC.Services.EndOfTerm.Business.QuoteInformation.GetQuoteData</a></div><div class="ttdeci">static DataSet GetQuoteData(int QuoteHistoryID, string QuoteType, bool UsePlayground)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00029">QuoteInformation.cs:29</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_a7dd78540ce884730d4d6f8e9d3b3e6a1"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a7dd78540ce884730d4d6f8e9d3b3e6a1">GFSC.Services.EndOfTerm.Business.QuoteInformation.CalculateUnpaidSalesTax</a></div><div class="ttdeci">static void CalculateUnpaidSalesTax(string AssetIDList)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00359">QuoteInformation.cs:359</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_ac87186a3ef46a918f343cc116669fd5a"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#ac87186a3ef46a918f343cc116669fd5a">GFSC.Services.EndOfTerm.Business.QuoteInformation.GetBuyoutUpgradeQuoteMiscDataInfoZone</a></div><div class="ttdeci">static DataSet GetBuyoutUpgradeQuoteMiscDataInfoZone(string QuoteHistoryID)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00049">QuoteInformation.cs:49</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html">GFSC.Services.EndOfTerm.Business.QuoteInformation</a></div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00007">QuoteInformation.cs:7</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_a3dd309d2f414a21754fe4873ec8657c5"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a3dd309d2f414a21754fe4873ec8657c5">GFSC.Services.EndOfTerm.Business.QuoteInformation.GetQuoteMessages</a></div><div class="ttdeci">static DataSet GetQuoteMessages(int QuoteHistoryID)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00338">QuoteInformation.cs:338</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_addf81d446292ceb91b9d98db9cf07191"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#addf81d446292ceb91b9d98db9cf07191">GFSC.Services.EndOfTerm.Business.QuoteInformation.SaveUpdatedQuoteData</a></div><div class="ttdeci">static int SaveUpdatedQuoteData(int QuoteHistoryID, string NewQuotedBy, string NewQuotedFor, DateTime NewExpirationDate, string NewComment)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00318">QuoteInformation.cs:318</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_ac9c7044adf8240f88acd089eef7257f6"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#ac9c7044adf8240f88acd089eef7257f6">GFSC.Services.EndOfTerm.Business.QuoteInformation.AddInvoicedChargeInfoZone</a></div><div class="ttdeci">static bool AddInvoicedChargeInfoZone(int QuoteHistoryID, string ContractID, string GLCode, string DealerID, string Description, string DueDate, decimal Amount)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00343">QuoteInformation.cs:343</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_a1ed86097ab0677ef0fbb381a444ee2d6"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#a1ed86097ab0677ef0fbb381a444ee2d6">GFSC.Services.EndOfTerm.Business.QuoteInformation.CalculateAllQuotes</a></div><div class="ttdeci">static int CalculateAllQuotes(string QuotedBy, string QuotedFor, string DealerID, int CustomerID, string AssetIDList, string IsPartialList, bool IncludeFutures, bool IsInternal, bool AllowUpgradeToKeep, bool AllowUpgradeToReturn, bool AllowBuyoutToKeepLessee, bool AllowBuyoutToKeepVendor, bool AllowBuyoutToReturn, string Comments, string Messages, bool IncludeEstimatedPropertyTaxes)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00009">QuoteInformation.cs:9</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_aefb3431470834760912e5f695ac8a704"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#aefb3431470834760912e5f695ac8a704">GFSC.Services.EndOfTerm.Business.QuoteInformation.GetMiscDetails</a></div><div class="ttdeci">static DataSet GetMiscDetails(int QuoteHistoryID, string QuoteType, string ContractID, bool UsePlayground)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00064">QuoteInformation.cs:64</a></div></div>
<div class="ttc" id="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information_html_ab289a41ea16998c0a5ffa196b8eb9f64"><div class="ttname"><a href="class_g_f_s_c_1_1_services_1_1_end_of_term_1_1_business_1_1_quote_information.html#ab289a41ea16998c0a5ffa196b8eb9f64">GFSC.Services.EndOfTerm.Business.QuoteInformation.SearchQuoteHistory</a></div><div class="ttdeci">static DataSet SearchQuoteHistory(string QuoteHistoryID, string DealerName, string ContractID, string CustomerID, string LesseeName, string QuoteAmount, string QuoteDate, bool ShowAllQuotes)</div><div class="ttdef"><b>Definition:</b> <a href="_business_2_quote_information_8cs_source.html#l00039">QuoteInformation.cs:39</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
